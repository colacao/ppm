var configs = {
		hot:{"国内酒店":"102001|首页@102002|搜索结果页@102003|搜索酒店详情页@102005|填写预订信息页@102006|核对订单信息页@102007|成功提交订单页@102008|查看酒店点评页@102009|查看用户所有点评页@102011|我要点评页@102012|补充点评页@102013|查看历史点评页@102014|生成延住订单页@102015|修改订单房型页@102016|酒店实景图页@102017|网上预付说明页@102018|酒店订单详情页@102019|酒店订单列表页@102020|酒店订单取消页@102021|系统正忙页@102022|热门城市酒店列表页@102023|热门城市酒店详情页@102024|弹出地图页@102025|点评出错提示页@102026|携程用户评级说明页@102028|推荐酒店页@102029|酒店对比页@102030|地图搜索页页@102031|特色主题酒店查询页@102032|搜索无结果页@102080|SEO品牌酒店列表页@102081|SEO品牌酒店详情页@102082|SEO品牌酒店地区列表页@200190|国内酒店搜索结果页（SEO）","海外酒店":"102101|首页@102102|搜索结果页@102103|详情页@102104|详情页SEO@102105|预订页@102106|核对信息页@102107|成功提交页","国内机票":"0|核对信息页（入口暂缓订单）@101001|农行网银支付返回页面@101002|机加酒订单核对页@101003|Ali支付返回页@101004|特殊订单申请列表页@101005|建行网银支付返回页@101006|SEO特价机票1@101007|SEO特价机票2@101008|SEO出发城市机票预订1@101009|成功提交订单页@101010|核对订单信息页@101011|团队机票需求单填写页@101012|机加酒订单列表页@101013|机加酒填写配送支付方式页@101014|填写配送方式页@101015|填写预订信息页@101016|航位已满提示页@101017|机票订单列表页@101018|特殊订单申请提交结果页@101019|SEO特价机票3@101020|SEO出发城市机票预订2@101021|时刻表查询结果页@101022|时刻表查询页@101023|首页@101025|SEO特价机票4@101026|系统出错页面@101027|第一程航班搜索结果页@101028|往返特价机票列表页@101029|第二程航班搜索结果页@101030|单程特价机票列表页１@101032|SEO出发城市机票预订3@101033|单程特价机票列表页２@101034|特殊订单申请填写信息页@101036|财付通支付返回页@101037|查看机酒订单详情页@101038|机票订单详情/取消页@101039|网上预订需知页@101040|低价订阅提醒页@101041|已订阅的低价提醒页@101042|低价看板页（单程）@101043|低价看板页（往返）@101044|海南航空@101045|云南祥鹏航空@101046|首都航空@101047|四川航空@101049|航班实时起降信息地图显示","国际机票":"104001|首页@104002|第一程航班搜索结果页@104003|第二程航班搜索结果页@104004|填写预订信息页@104005|填写配送方式页@104006|核对订单信息页@104007|填写信用卡页@104008|成功提交订单页@104009|机票订单列表页@104010|机票订单详情页@104011|国际机票办理乘机@104012|搜索无结果页@104013|机票需求单填写页@104014|机票订单取消页@104016|特价机票列表页@104017|机票需求单样本页@104018|网上预订须知页@104019|票询价单提交成功页@104020|第一程航班搜索结果页(新)@104021|第二程航班搜索结果页(新）@104022|多程航班搜索结果页@804001|时刻表查询页","旅游度假":"103001|首页@103002|目的地搜索结果页@103003|产品详情页@103004|酒店机票确认页@103005|选择附加产品页@103006|填写预订信息页@103007|填写配送方式页@103008|核对订单信息页@103009|成功提交订单页@103010|报错页@103011|专卖店产品列表页@103012|查看订单列表页@103013|查看订单详情页@103014|度假常识页@103015|修改机票页@103016|修改酒店页@103017|产品对比页@103023|抛出异常页@103024|专卖店选择目的地页@103025|推荐行程要求选择页@103026|公告列表页@103027|公告详情页@103028|可选项详细信息@103029|房型详细信息@103030|特卖会首页@103031|特卖会24小时内页@103032|特卖会24小时外页@103033|旅游度假 @103034|旅游度假 @103035|旅游度假 @103036|旅游度假 @103037|旅游度假 @103038|酒店机票确认页库存不足@103039|成功提交订单页库存不足@103040|目的地搜索无结果页@103041|签证首页@103201|邮轮首页@503001|主题推荐列表页@503002|主题推荐详情页@10300100|旅游首页@10300101|国内旅游首页@10300102|海外旅游首页@10300103|周边旅游首页@10300104|当地游/票券首页@10300107|旅游咨讯首页@10300207|旅游度假咨询搜索结果页@10310207|咨讯专区页@10311301|团队游(打包团队游)详情页（国内）@10311302|团队游(打包团队游)详情页（海外）@10330307|攻略列表页@10330407|攻略汇总页@10330507|攻略汇总页@10340407|游记详情页@10350307|景点列表页@10350407|景点详情页@10360307|视频列表页@10360407|视频详情页@10360507|全部视频页","高铁":"108001|首页@108002|搜索结果页@108003|搜索无结果页@108004|填写预订信息页@108005|核对订单信息页@108006|成功提交订单页@108007|时刻表@108008|支付完成页@108009|时刻表站站查询@108010|时刻表车次查询@108011|时刻表车站查询@10800190|城市火车票预订@10800990|时刻表站站查询(seo)@10801190|时刻表车站查询(seo)","注册相关页面":"100001|填写注册信息页@100002|注册成功提示页@100028|注册相关页面邮件注册首页@100029|注册相关页面邮箱注册验证@100030|注册相关页面手机注册首页@100031|注册相关页面手机验证@100032|注册相关页面邮箱注册成功@100033|注册相关页面手机注册成功@100034|注册相关页面合作卡注册@100035|注册相关页面优惠代码注册@100036|注册相关页面合作卡注册--默认手机验证@100037|注册相关页面合作卡注册--邮箱验证@100038|注册相关页面合作卡注册成功@100039|注册相关页面优惠代码注册成功@100040|注册相关页面邮件链接出错页面@100042|注册激活页","用户登陆相关页面":"100003|用户登陆页@100004|跳转用户登陆页@100041|用户登陆相关页面快速预订订单查询","找回密码相关页面":"100005|找回方式页@100006|找回密码验证姓名页@100019|用户名验证@100020|重置新密码@100027|重置成功页","系统出错信息相关页面":"100007|系统出错信息页","我的携程":"100008|积分明细页@100009|兑换记录页@100010|抵用券页@100011|游票页@100012|安全设置页@100013|个人资料页@100014|密码修改页@100015|常用旅游信息页@100016|常用地址页@100017|常住酒店页@100018|美食订单页@100021|我的携程首页","全站首页":"100101|全站首页@100102|语言选择页","订单管理相关页面":"101031|我的行程页@102027|酒店订单状态说明页@701001|国内机票订单详情页@701002|国内机票订单状态说明页@702002|国内酒店订单详情页@703001|度假订单状态说明页@703002|旅游度假订单详情页@703003|旅游度假机酒订单详情页@703004|旅游度假暂存订单详情页@703005|旅游度假订单打印页@703101|欧铁订单详情页@703102|欧铁订单打印页@704001|国际机票订单详情页@704002|国际机票订单状态说明页@706001|订单点评页@706002|未出行订单列表页@706003|酒店订单列表页@706004|机票订单列表页@706005|机酒订单列表页@706006|旅游度假订单列表页@706007|高铁订单列表页@708001|高铁订单详情页@708002|高铁订单打印页","工具箱相关页面":"151001|航班实时起降信息页@151002|我的历史记录@151003|网上选座说明页@151004|网上选座报错友情提示页@151005|网上选座页","帮助中心":"250001|首页@250002|搜索结果页@250003|搜索无结果页@250004|问题列表页@250005|问题详情页@250006|自助服务页@250007|新手上路首页@250008|新手上路教程页@250009|新手上路flash教程页@250010|公告列表页@250011|公告详情页","特约商户":"200001|酒店周围打折商户查询页","社区":"300001|查看城市酒店排行页@300501|首页@300502|查询出错页@300503|系统出错页@301501|游记攻略总页@301502|游记攻略详情页（早期地址）@301503|游记攻略详情页@301504|区域游记攻略城市列表@301505|城市游记攻略列表@302501|问答总页（新版：弃用）@302502|问答讨论总页@302503|问答讨论详情页（另一形式）@302504|问答讨论详情页（另一形式）@302505|问答讨论详情页@302506|区域问答城市列表@302507|城市问答列表@303501|目的地探索区域旅游指南@303502|目的地探索城市旅游指南@303503|目的地探索城市行前指南@303504|目的地探索城市游玩手册@303505|目的地探索区域景点排名@303506|目的地探索城市景点排名@303507|目的地探索城市景点详情页@303508|目的地探索区域城市酒店列表@303509|目的地探索城市酒店排名@303510|目的地探索城市酒店详情页@303511|目的地探索区域城市餐馆列表页@303512|目的地探索城市餐馆列表页@303513|目的地探索城市餐馆详情页@303514|目的地探索城市景点/酒店分布地图页@303515|目的地探索城市特色地图集/景点分布图@303516|目的地探索城市照片查看页@303517|目的地探索会员城市推荐列表页@303518|目的地探索会员城市推荐详情页@303519|目的地探索首页（社区版）@303520|目的地探索中国旅游导航@303521|目的地探索亚洲旅游导航@303522|目的地探索大洋洲旅游导航@303523|目的地探索欧洲旅游导航@303524|目的地探索非洲旅游导航@303525|目的地探索北美旅游导航@303526|目的地探索南美旅游导航@304501|个人主页：个人简介@304502|个人主页-旅行发现：用评列表页@304503|个人主页-旅行发现：照片列表页@304504|个人主页-旅行发现：问答列表页@304505|个人主页-旅行发现：论坛帖子列表页@304506|个人主页-旅行发现：近游记攻略列表页@304507|个人主页-旅行发现：推荐列表页@304508|个人主页-足迹地图：我的足迹@304509|个人主页-足迹地图：我的足迹秀@304510|个人主页-足迹地图：朋友的足迹秀@304511|个人主页-足迹地图：所有人的足迹秀@304512|个人主页：参谋团页@304513|个人主页：订阅跟踪列表@304514|个人主页：订阅跟踪退订按钮（跳转）@304515|个人主页：站内留言@304516|个人主页-活动：结伴出游页@304517|个人主页-活动：同城聚会页@304518|个人主页：收藏@304519|别人眼中的我：个???简介@304520|别人眼中的我-旅行发现：用评列表页@304521|别人眼中的我-旅行发现：照片列表页@304522|别人眼中的我-旅行发现：问答列表页@304523|别人眼中的我-旅行发现：论坛帖子列表页@304524|别人眼中的我-旅行发现：近游记攻略列表页@304525|别人眼中的我-旅行发现：推荐列表页@304526|别人眼中的我-足迹地图：我的足迹秀@304527|别人眼中的我-足迹地图：朋友的足迹秀@304528|别人眼中的我-足迹地图：所有人的足迹秀@304529|别人眼中的我：参谋团页@304530|别人眼中的我-活动：结伴出游页@304531|别人眼中的我-活动：同城聚会页@305501|结伴同游总页@305502|其他景区结伴游详情页@305503|结伴同游详情页@305504|区域结伴同游城市列表@305505|城市结伴同游列表@306501|社区帮助论坛页@306502|社区帮助论坛详情页@306503|社区帮助论坛反馈建议（发帖）@307501|七嘴八舌论坛总页@307502|七嘴八舌论坛帖子@307503|目的地专家申请页@308501|同城聚会详情页@308502|城市同城聚会列表页","时令推荐":"600001|推荐首页@600002|推荐详情页@600003|搜索结果页@600004|搜索无结果页","其他":"107001|offline预订登录@107002|offline预订登录asp@807001|国内代驾租车查询页@807002|代驾租车车辆选择页@807003|代驾租车填写预订信息页","特惠":"2001|进行中的团购@2002|订单填写页@2003|往期团购@2004|马上团订单@2005|常见问题@2006|团购订单完成页@900001|特卖会首页@902201|神秘酒店首页@902202|神秘酒店搜索结果页@902203|神秘酒店详情页@902204|神秘酒店填写预订信息页@902205|神秘酒店核对订单信息页@902206|神秘酒店成功提交订单页@903001|特卖旅游度假","市场推广合作相关":"500001|待定","机酒":"5001|酒店列表页@5002|酒店详情页@105001|搜索结果页（单酒店）@105002|搜索结果页（双酒店）@105003|机票选择页@105004|酒店选择页@105005|度假可选项页面@105006|填写信息页@105007|核对信息页@105008|订单完成页","惠选酒店":"102047|预订完成页（有时)@102401|首页@102402|搜索结果页@102403|详情页@102404|点评填写页@102405|点评成功页@102406|预订填写页@102407|预订完成页@102408|订单详情页@102409|订单重新选择页@102410|选择房型页@102411|支付平台反向查看订单详情查看页 @102412|未提交订单的确认页 @102413|订单打印页 @102414|图选搜索结果页@102415|图选详情页@102416|全部城市@102417|具体城市@102418|首页到搜索结果页中间的跳转页面@102419|入住用户说@102420|公社订单页@102421|公社收藏页","海外酒店GTA":"102108|预订页@102109|核对支付页@102110|GTA成功提交页@102111|详情页@102112|详情页SEO","携程个人首页":"401501|写游记攻略@401502|编辑游记@402501|提问@403501|发表照片@403502|发表照片（跳转）@403503|发表照片@403504|编辑照片@403505|发表照片（跳转）@403506|创建推荐列表@403507|创建推荐列表@404501|会员个人主页@404502|会员的全部照片@404503|我的足迹秀（跳转）@405501|发起结伴游@407501|七嘴八舌：发表新帖@408501|发起同城聚会","游票":"100022|游票首页@100023|预订页@100024|完成页@100025|订单列表@100026|订单详情","欧铁":"103101|欧铁首页@103102|搜索结果页（去返程）@103103|搜索结果页（座位预订）@103104|通票详情页@103105|填写信息页@103106|核对信息页@103107|订单完成页@103108|车厢等级介绍@103109|高速列表介绍@103110|乘客类型说明","Clabs":"350001|酒店地图页@350002|酒店地图帮助页","":""},
		url:"/nj/getcity/{$key}"
};
(function($) {
	var contains = document.compareDocumentPosition ?function(a, b) {
		try{
		return !! (a.compareDocumentPosition(b) & 16);
		}catch(err){}
	}: function(a, b) {
		return a !== b && (a.contains ? a.contains(b) : true);
	};
	String.prototype.trim = function() {
		return this.replace(/(^\s*)|(\s*$)/g, "");
	};
	String.prototype.replaceWith = function(d) {
		return this.replace(/\{\$(\w+)\}/g, function(a, c) {
			if (c in d) {
				return d[c];
			} else {
				return a;
			}
		});
	};
	Function.prototype.bind = function(a) {
		var c = this;
		var d = [].slice.call(arguments, 1);
		return function() {
			return c.apply(a, d.concat([].slice.call(arguments, 0)));
		};
	};
	var PageSelector = function(opts) {
		var defaults = {
			configs:null,
			window:window,
			showEvent:"focus",
			className:"",
			tiptxt:"可直接输入，或者从下面选择",
			template: {
				content: '<div style="display:none" class="page_drop {$className}">{$tip}{$hotandlistcontent}</div>',
				tip: '<div class="page_drophot">{$tiptxt}</div>',
				hotandlistcontent:'<div class="page_droplist" style="position:relative"><div class="btn_arrow_wapper"><i class="arrow_l"></i><i class="arrow_r"></i></div>{$hotcontent}{$listcontent}</div>',
				hotcontent: '<ul class="page_droplist_tab clearfix">{$hottab}</ul>',
				hottab:'<li  data="{$index}" class="tab_item {$selected}" style="display:{$display};">{$tagname}</li>',
				listcontent: '<ul data="{$index}" class="page_droplist_item" style="display:{$display}">{$list}</ul>',
				list:'<li data="{$pageid}  {$pagename}"><span class="page_name">{$pagename}</span><span class="page_value">{$pageid}</span></li>'
			},
			styles: "ul{margin:0; padding:0;}article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section{display: block;}table{border-collapse:collapse;border-spacing:0px;}fieldset,img,hr{border:0;}address,caption,cite,code,dfn,em,strong,th,var{font-style:normal; font-weight:normal;}ol,ul{list-style:none;}caption,th{text-align:left;}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal;}abbr,acronym{border:0;}/* Font */body{font:12px/1.5 Simsun, sans-serif;}select, input, button, textarea{font-size:12px;}table{font-size:inherit; font:100%;}h1, h2, h3, h4, h5 ,h6{font-family:Simsun, sans-serif;} /* Link */a{color:#333; text-decoration:none;} a:hover{text-decoration:underline;}/*下拉页面选择样式 page_drop*/.page_drop{position:absolute; border-radius: 5px 5px 0 0;width:350px; box-shadow: 2px 2px 5px rgb(51, 51, 51); border:1px solid #1e7d9d; background-color:#fff;}.page_drophot{height:24px; padding-left:10px; line-height:24px; background-color:#03b5de; color:#fff;}.page_droplist{padding:5px; overflow:hidden;}.page_droplist_tab{border-bottom: 1px solid #5DA9E2; height:24px;}.page_droplist_tab .tab_item{float: left; height: 24px; padding:0 10px; line-height: 24px; text-align: center; color: #005DAA; cursor: pointer;}.address_hot_abb li span{padding:0 8px;}.page_droplist_tab .tab_selected{position:relative; border-color:#5DA9E2 #5DA9E2 transparent; border-style:solid solid none; border-width: 1px 1px 0; background-color:#fff; color: #000000; font-weight: bold; background-color:#fff;}.page_droplist_item{padding-top:10px;}.page_droplist_item li{height: 24px; padding:0 10px; line-height:24px; overflow: hidden; cursor:pointer;}.page_droplist_item li:hover{background-color:#d3f3fe;}.page_droplist_item .page_name{float:left;}.page_droplist_item .page_value{float:right;}"
		};

		$.extend(defaults, opts);
		this.initialize(defaults);
	};
	PageSelector.prototype = {
		initialize: function(opts) {
			this.setOptions(opts);
			this.createStyle();
			this.render();
			this.bindEvent();
		},
		setOptions: function(opts) {
			$.extend(this, opts);
			this.target = $(this.target);
		},
		createStyle: function() {
			if(!this.styles){
				return;
			}
			if ($.browser.isIE) {
				sty = this.window.document.createStyleSheet();
				sty.cssText = this.styles
			} else {
				sty = this.window.document.createElement('style');
				sty.type = "text/css";
				sty.textContent = this.styles;
				this.window.document.getElementsByTagName('head')[0].appendChild(sty)
			}
		},
		bindEvent: function() {
			this.bindFocusEvent();
			this.bindBlurEvent();
			this.bindMouseDownEvent();
			this.bindClickEvent();
			this.bindKeyEvent();
			this.bindArrowEvent();
			// this.bindAddNumEvent();
			// this.bindMoveEvent();
			// this.bindDragEvent();
			this.bindMouseUpEvent();
			this.setOther();
		},
		isChildOf :function(parentEl, el, container) {
                if (parentEl == el) {
                    return true;
                }
                if (parentEl.contains) {
                    return parentEl.contains(el);
                }
                if ( parentEl.compareDocumentPosition ) {
                    return !!(parentEl.compareDocumentPosition(el) & 16);
                }
                var prEl = el.parentNode;
                while(prEl && prEl != container) {
                    if (prEl == parentEl)
                        return true;
                    prEl = prEl.parentNode;
                }
                return false;
       },
		setOther:function(){
			var self = this;
			$(document).bind('mousedown',function(ev){
				if (!ev.target){
                    ev.target=ev.srcElement||document;
                }
                if (ev.target!==null&&ev.target.nodeType===3){
                    ev.target=ev.target.parentNode;
                }
                if (ev.target !=  self.target && !self.isChildOf(self.target.floatEl, ev.target, self.target.floatEl)) {
                 
					self.isFocus = false;
					self.target.floatEl.style.display='none';
                }
			})
		},
		bindMouseUpEvent:function(){
			this.doReleaseCapture();
		},
		bindArrowEvent:function(){
			var self = this;
			$(this.target.floatEl).bind("click",function(e){
				e = e||event;
				var tag = e.target||e.srcElement;
				var temp  = tag.className.match(/arrow_(.*)/);
				if(!temp){
					return;
				}
				var tempItem = null;
				$(".tab_item",self.target.floatEl).each(function(i,item){
					if(item.style.display==""){
						tempItem = $(item);
						return;
					}
				});
				if(temp[1]=="r"){
					var index = $(".tab_item",self.target.floatEl).index(tempItem);
					if(index>$(".tab_item",self.target.floatEl).length-4){
						return;
					}
					//console.log(index,$(".tab_item",self.target.floatEl).length)
					var arr={};
						for(var j=0;j<4;j++){
							arr[j+index+1]=1;
						}
					$(".tab_item",self.target.floatEl).each(function(i,item){
						
						
						if(arr[i]){
							
							item.style.display="";
						}else{
							item.style.display="none";
						}
					});
					return;
				}
				if(temp[1]=="l"){
					var index = $(".tab_item",self.target.floatEl).index(tempItem);
					if(index<4){
						return;
					}
					var arr={};
						for(var j=0;j<4;j++){
							arr[index-j-4]=1;
						}
					$(".tab_item",self.target.floatEl).each(function(i,item){
						
					
						if(arr[i]){
							
							item.style.display="";
						}else{
							item.style.display="none";
						}
					});
					return;
				}
			
				
			});
		},
		changeTab:function(tag){
			var index = tag.getAttribute("data");
			this.setTab(index);
		},
		setTab:function(index){
			var tabs = $(this.target.floatEl).find(".tab_item");
			var lists = $(this.target.floatEl).find(".page_droplist_item");
			tabs.removeClass("tab_selected").each(function(i,item){
				$(item).addClass((i==index?"tab_selected":""));
			});
			lists.each(function(i,item){
				item.style.display=(i==index?'':"none");
			});
		},
		setPos:function(pos){
			var xy = $(this.target.floatEl).offset();
			var tagxy = $(this.target).offset();
			if(tagxy.left+$(this.target.floatEl).width()>$(window).width()){
				//pos.left = tagxy.left + 'px';
				pos.left = 0;
			}
			$(this.target.floatEl).css('width',$(window).width()-3+'px')
			$(this.target.floatEl).offset(pos);
		},
		isFocus:false,
		lastKey:"",
		bindKeyEvent:function(){
			var self = this;
			//if(this.target.type && this.target.type=="text"){
				this.target.bind('keyup',function(e){
					if(e.keyCode==13 && this.value.length){
						self.setValue(this.value+" ");
						if(self.onChange){
							self.onChange.call(this,this.value);
							return;
						}			
					}
				});
				this.target.bind(self.showEvent,function(e){
					
				
					var input  = this;
					input.oldValue = input.value;
					input.value="";
					
					(function(){
						if(self.isFocus){
							// if(self.target.type!="textbox"){
								// return;
							// }
							if(self.lastKey!=input.value){
								self.lastKey = input.value;
								if(input.value.length && input.value.length>1){
									self.getData(input.value);
								}else{
									self.render();
									self.bindEvent();
									self.show();
								}
							}else{
							
							
							}
							setTimeout(arguments.callee,100);
						}
					})();
				});
			//}
		},
		setData:function(data){
			$(this.target.floatEl).find(".page_drophot").html("按拼音排序");
			var page_droplist = $(this.target.floatEl).find(".page_droplist");
			page_droplist.html("");
			var arr = [];
	
			$.each(data,function(i,item){
					
					arr.push(this.template.list.replaceWith({
						pagename:item.NAME,
						pageid:item.ID
					}));
				
			}.bind(this));
			page_droplist.html(this.template.listcontent.replaceWith({
				list:arr.join(''),
				index:0,
				display:""
			}));
		},
		getData:function(val){
			var self = this;
			if(this.configs.url){
				$.get(this.configs.url.replaceWith({
					key:val
				}),function(data){
					self.setData(data);
				},"json");
			}
		},
		bindClickEvent:function(){
			var self = this;
		
			$(this.target.floatEl).bind("click",function(e){
				e = e||event;
				var tag = e.target||e.srcElement;
				self.clickEvent(tag);
			});
		},
		bindMouseDownEvent:function(){
			$(this.target.floatEl).bind("mousedown",function(e){
				return false;
			});
		},
		setValue:function(val){
			
			this.target.val(val);
			this.hide();
			this.target[0].blur();
		},
		doReleaseCapture:function () {
            if (PageSelector.ctObj && PageSelector.ctObj.releaseCapture) {
               PageSelector.ctObj.releaseCapture();
               PageSelector.ctObj = null;
            }
        },
		doSetCapture:function (obj) {
            if (obj.setCapture) {
                this.doReleaseCapture();
                obj.setCapture();
                PageSelector.ctObj = obj;
            }
        },
		bindBlurEvent:function(){
			
			var self = this;
			this.target.bind('blur',function(e){
				if(!self.target[0].value.length){
					self.target[0].value = self.target[0].defaultValue;
				}
				//self.doReleaseCapture();
			//	e = e||event;
				//self.isFocus = false;
				//self.target.floatEl.style.display='none';
				
			});
			var pos = this.target.offset();
			pos.top += this.target.outerHeight();
			self.setPos(pos);
		},
		bindFocusEvent:function(){
			var self = this;
			
			this.target.bind(this.showEvent,function(){
				this.isFocus = true;
				if(this.target[0].type=="textbox"){
					this.target[0].select();
				}
				this.show();
				self.target.floatEl.onmousedown = function (e) {
					//self.doSetCapture(self.target[0]);
					//return false;
				};
			}.bind(this))
			if(this.showEvent!="focus"){
				$(document.body).bind("click",function(e){
					var toElement = e.relatedTarget || e.toElement;
					var tag = e.target||e.srcElement;
					
					if(tag!=this.target[0] && !contains(this.target.floatEl,tag)){
					
						this.hide();
					}
				}.bind(this));
			}
		},
		clickEvent: function(tag) {
			//alert(tag);
			if($(tag).hasClass("tab_item")){
				this.changeTab(tag);
				return;
			};
			var lis = $(tag).parents("li");
			if(lis.length || tag.tagName=="LI"){
				tag  = lis.length?lis:$(tag);
				this.setValue(tag.attr('data'));
					
				if(this.onChange){
					this.onChange.call(this,tag.attr('data'));
					return;
				}
			}
		},
		hide: function() {
			this.target.floatEl.style.display='none';
		},
		show: function(date) {
			
			this.target.floatEl.style.display='';
			var pos = this.target.offset();
			pos.top += this.target.outerHeight();
			this.setPos(pos);
		},
		createTip:function(){
			var retHtml = '';	
			retHtml = this.template.tip.replaceWith({
				tiptxt:this.tiptxt
			});
			return retHtml;
		},
		createHot: function() {
			var retHtml = [];
			var index=0;
			for(var b in this.configs.hot){
				retHtml.push(this.template.hottab.replaceWith({
					tagname:b,
					index:index,
					selected:index?"":"tab_selected",
					display:index<4?"":"none"
				}));
				index++;
			}
			return this.template.hotcontent.replaceWith({
				hottab:retHtml.join('')
			});
		},
		createList:function(){
			var retHtml = [];
			var index=0;
			for(var b in this.configs.hot){
				retHtml.push(this.template.listcontent.replaceWith({
					index:index,
					display:index?"none":"",
					list:(function(data){
							var datas = data.split('@');
							var arr=[];
							$.each(datas,function(i,item){
								var items = item.split('|');
								if(i<10){
									arr.push(this.template.list.replaceWith({
										pagename:items[1],
										pageid:items[0]
									}));
								}
							}.bind(this));
							return arr.join('')
						}.bind(this))(this.configs.hot[b])
					}));
					index++
			}
			return retHtml.join('');
		},
		createBody: function() {		
			var retHtml = '';
			var retHtml = this.template.hotandlistcontent.replaceWith({
				hotcontent:this.createHot(),
				listcontent:this.createList()
			});
			return retHtml;
		},
		createTempEl: function(str) {
			var tempDiv = document.createElement('div');
			tempDiv.innerHTML = str;
			return tempDiv.firstChild;
		},
		render: function() {
			if(this.target.floatEl){
				this.target.floatEl.parentNode.removeChild(this.target.floatEl);
			}
			this.target.floatEl = this.createTempEl(this.template.content.replaceWith({
				className:this.className,
				tip:this.createTip(),
				hotandlistcontent:this.createBody()
			}));
			this.window.document.body.appendChild(this.target.floatEl);
		}
	};
	$.fn.PageSelector = function(options) {
		var defaults = {
			target: null
		};
		$.extend(defaults, options);
		defaults.target = this[0];
		new PageSelector(defaults);
	}
})(jQuery);